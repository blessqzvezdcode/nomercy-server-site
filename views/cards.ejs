<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–∞—Ä—Ç–æ—á–∫–∏ - NoMercy</title>
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/css/cards.css">
</head>
<body>
    <nav>
        <a href="/" class="brand">NoMercy</a>
        <div class="nav-buttons">
            <% if (user) { %>
                <a href="/messenger" class="nav-messenger-btn" title="–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä">üí¨</a>
                <div class="dropdown">
                    <button class="dropdown-toggle">
                        <span>üë§ <%= user.name %> (üí∞ <%= balance %>)</span>
                    </button>
                    <div class="dropdown-menu">
                        <a href="/" class="dropdown-item">üè† –ì–ª–∞–≤–Ω–∞—è</a>
                        <a href="/profile/<%= user.id %>" class="dropdown-item">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
                        <a href="/market" class="dropdown-item">üõí –ú–∞—Ä–∫–µ—Ç</a>
                        <a href="/cards" class="dropdown-item active">üÉè –ö–∞—Ä—Ç—ã</a>
                        <a href="/quests" class="dropdown-item">‚öîÔ∏è –ö–≤–µ—Å—Ç—ã</a>
                        <a href="/games" class="dropdown-item">üéÆ –ò–≥—Ä—ã</a>
                        <a href="/news" class="dropdown-item">üì∞ –ù–æ–≤–æ—Å—Ç–∏</a>
                        <a href="/faq" class="dropdown-item">‚ùì FAQ</a>
                        <a href="/achievements" class="dropdown-item">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</a>
                        <a href="/support" class="dropdown-item">üéß –ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
                        <div class="dropdown-divider"></div>
                        <% if (user.role === 'admin') { %>
                            <a href="/admin" class="dropdown-item">‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞</a>
                            <div class="dropdown-divider"></div>
                        <% } %>
                        <button class="dropdown-item theme-toggle" id="theme-toggle">üåô –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞</button>
                        <div class="dropdown-divider"></div>
                        <a href="/logout" class="dropdown-item">üö™ –í—ã–π—Ç–∏</a>
                    </div>
                </div>
            <% } else { %>
                <a href="/auth/discord" class="btn">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Discord</a>
            <% } %>
        </div>
    </nav>


<div class="container">
  <div class="cards-header">
    <div class="cards-info">
      <h1 class="cards-title">üÉè –ö–æ–ª–ª–µ–∫—Ü–∏—è –∫–∞—Ä—Ç</h1>
      <p class="cards-subtitle">–û—Ç–∫—Ä—ã–≤–∞–π –ø–∞–∫–∏, —Å–æ–±–∏—Ä–∞–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ —Ç–æ—Ä–≥—É–π –∫–∞—Ä—Ç–∞–º–∏</p>
    </div>
    <div class="balance-card">
      <div class="balance-header">
        <span class="balance-icon">üí∞</span>
        <span class="balance-label">–í–∞—à –±–∞–ª–∞–Ω—Å</span>
      </div>
      <div class="balance-amount" id="balance"><%= balance %></div>
      <div class="balance-currency">NMCoin</div>
    </div>
  </div>

  <div class="cards-tabs">
    <button class="tab-btn active" id="tab-gacha">üé∞ Cards Gacha</button>
    <button class="tab-btn" id="tab-collection">üìö –ö–æ–ª–ª–µ–∫—Ü–∏—è</button>
    <button class="tab-btn" id="tab-collections">üèÜ –ö–æ–ª–ª–µ–∫—Ü–∏–∏</button>
  </div>

  <!-- Pity Counter Display -->
  <div class="pity-display" style="margin-bottom:20px;">
    <div class="pity-label">–°—á–µ—Ç—á–∏–∫ –∂–∞–ª–æ—Å—Ç–∏:</div>
    <div class="pity-amount" id="pity-counter">0</div>
    <div class="pity-info">/ 80 (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è)</div>
  </div>

  <!-- Collection Section -->
  <div id="collection-section" class="collection-section" style="display: none;">
    <h2>üìö –ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è</h2>
    <div id="user-cards" class="cards-grid">
      <!-- User's cards will be loaded here -->
    </div>
    <div id="empty-collection" class="empty-collection" style="display: none;">
      <div class="empty-icon">üìö</div>
      <h3>–ö–æ–ª–ª–µ–∫—Ü–∏—è –ø—É—Å—Ç–∞</h3>
      <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ Cards Gacha, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏!</p>
    </div>
  </div>

  <!-- Gacha Section -->
  <div id="gacha-section" class="gacha-section">
    <div class="gacha-header">
      <h2>üé∞ Cards Gacha</h2>
      <p class="gacha-subtitle">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–¥–∞—á—É –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–¥–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏!</p>
      
      <!-- Collection Selector -->
      <div class="collection-selector">
        <label for="collection-select">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é:</label>
        <select id="collection-select" onchange="changeCollection(this.value)">
          <option value="all">–í—Å–µ –∫–∞—Ä—Ç—ã</option>
          <option value="launch_2025">–ó–∞–ø—É—Å–∫ 2025</option>
        </select>
      </div>
    </div>

    <div class="gacha-machines">
      <!-- Single Pull -->
      <div class="gacha-machine">
        <div class="machine-header">
          <h3>üéØ –û–¥–∏–Ω–æ—á–Ω–∞—è –∫—Ä—É—Ç–∫–∞</h3>
          <div class="machine-price">50 NMCoin</div>
        </div>
        <div class="machine-description">
          <p>–û–¥–Ω–∞ —Å–ª—É—á–∞–π–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞</p>
          <div class="drop-rates">
            <span class="rate">Common: 60%</span>
            <span class="rate">Uncommon: 25%</span>
            <span class="rate">Rare: 12%</span>
            <span class="rate">Epic: 2.5%</span>
            <span class="rate">Legendary: 0.5%</span>
          </div>
        </div>
        <button class="gacha-btn single-pull" onclick="console.log('Button clicked!'); performGacha('single', this)">
          <span class="btn-icon">üéØ</span>
          –û–¥–∏–Ω–æ—á–Ω–∞—è –∫—Ä—É—Ç–∫–∞
        </button>
      </div>

      <!-- 10 Pull -->
      <div class="gacha-machine featured">
        <div class="machine-header">
          <h3>üî• 10 –∫—Ä—É—Ç–æ–∫</h3>
          <div class="machine-price">450 NMCoin</div>
          <div class="discount-badge">-10%</div>
        </div>
        <div class="machine-description">
          <p>10 –∫–∞—Ä—Ç–æ—á–µ–∫ —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–µ–¥–∫–æ–π</p>
          <div class="drop-rates">
            <span class="rate">Common: 50%</span>
            <span class="rate">Uncommon: 30%</span>
            <span class="rate">Rare: 15%</span>
            <span class="rate">Epic: 4%</span>
            <span class="rate">Legendary: 1%</span>
          </div>
        </div>
        <button class="gacha-btn ten-pull" onclick="performGacha('ten', this)">
          <span class="btn-icon">üî•</span>
          10 –∫—Ä—É—Ç–æ–∫
        </button>
      </div>

      <!-- Legendary Pull -->
      <div class="gacha-machine legendary">
        <div class="machine-header">
          <h3>üëë –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫—Ä—É—Ç–∫–∞</h3>
          <div class="machine-price">6000 NMCoin</div>
        </div>
        <div class="machine-description">
          <p>–¢–æ–ª—å–∫–æ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ –∫–∞—Ä—Ç—ã!</p>
          <div class="drop-rates">
            <span class="rate legendary-rate">Legendary: 100%</span>
          </div>
        </div>
        <button class="gacha-btn legendary-pull" onclick="performGacha('legendary', this)">
          <span class="btn-icon">üëë</span>
          –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫—Ä—É—Ç–∫–∞
        </button>
      </div>
    </div>

    <!-- Gacha Results -->
    <div id="gacha-results" class="gacha-results" style="display: none;">
      <div class="results-header">
        <h3>üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫—Ä—É—Ç–æ–∫!</h3>
        <button class="close-results" onclick="closeGachaResults()">&times;</button>
      </div>
      <div id="gacha-cards" class="gacha-cards-grid"></div>
    </div>
  </div>


  <div id="pack-modal">
    <div id="pack-overlay" class="pack-overlay"></div>
    <div class="pack-modal-content">
      <div class="pack-modal-header">
        <h3>üéÅ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–∞–∫–∞</h3>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>
      <div class="pack-results-container">
        <div id="pack-results" class="pack-results-grid"></div>
      </div>
      <div class="pack-modal-footer">
        <button class="btn" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- Collections Section -->
  <div id="collections-section" class="section" style="display:none;">
    <div class="card">
      <h3>üèÜ –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –∫–∞—Ä—Ç</h3>
      <div id="collections-list">
        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π...</div>
      </div>
    </div>
    
    <div class="card">
      <h3>üîç –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–∞—Ä—Ç—ã</h3>
      <div id="missing-cards">
        <div class="loading">–ü–æ–∏—Å–∫ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∫–∞—Ä—Ç...</div>
      </div>
    </div>
    
    <div class="card">
      <h3>‚ôªÔ∏è –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤</h3>
      <div class="recycle-section">
        <div class="recycle-info">
          <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—ã –¥–ª—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –≤ NMCoin:</p>
          <div class="recycle-values">
            <span class="value-item">Common: 10 NMCoin</span>
            <span class="value-item">Uncommon: 15 NMCoin</span>
            <span class="value-item">Rare: 25 NMCoin</span>
            <span class="value-item">Epic: 50 NMCoin</span>
            <span class="value-item">Legendary: 100 NMCoin</span>
          </div>
        </div>
        <div id="duplicate-cards" class="duplicate-cards-grid">
          <div class="loading">–ü–æ–∏—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤...</div>
        </div>
        <div class="recycle-actions" style="display:none;">
          <button id="recycle-all" class="btn recycle-all-btn">
            ‚ö° –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
          </button>
          <button id="recycle-selected" class="btn recycle-btn" disabled>
            ‚ôªÔ∏è –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
          </button>
          <div id="recycle-total" class="recycle-total">–ò—Ç–æ–≥–æ: 0 NMCoin</div>
        </div>
      </div>
    </div>
  </div>

  <script src="/js/packs.js"></script>

</div>
<script src="/js/ui-effects.js"></script>
<script src="/js/dropdown.js"></script>
<script src="/js/theme-switcher.js"></script>
</body>
</html>